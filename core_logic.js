function reconstruct_data(e){return e.join("")}function stream_from_b64(e){try{const t=atob(e);return Uint8Array.from(t,(e=>e.charCodeAt(0)))}catch(e){throw new Error(`${App.get_str(0)}${e.message}`)}}async function unseal_module_gcm(e,t){try{const a=App.stream_from_b64(e);if(a.length<12)throw new Error(App.get_str(1));const r=a.slice(0,12),n=a.slice(12),s=new TextEncoder,o=await crypto.subtle.importKey("raw",s.encode(t),{name:"PBKDF2"},!1,["deriveKey"]),p=await crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!0,["decrypt"]),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},p,n);return(new TextDecoder).decode(c)}catch(e){throw new Error(`${App.get_str(2)}${e.message}`)}}async function derive_key_from_secret(e,t){const a=new TextEncoder,r=await crypto.subtle.importKey("raw",a.encode(e),{name:"PBKDF2"},!1,["deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},r,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])}async function execute_proc_q(){if(App.op_lock_flag)return;App.op_lock_flag=!0;const e=App.ui_handles.key_field.value.trim(),t=App.ui_handles.data_input_field.value.trim();App.ui_handles.op_completed=!0,App.ui_handles.result_area.value="",App.ui_handles.result_area.classList.remove("error","success"),App.ui_handles.status_announcer.textContent="",App.ui_handles.copy_action_btn.classList.remove("copied");const a=reconstruct_data(["990f8b7f8ea02d04b1ffbb3a1c0e","f46663e3215e9ab36ec658a772","1177aac434"]);let r=0;try{for(r=await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return[...new Uint8Array(a)].map((e=>e.toString(16).padStart(2,"0"))).join("")}(e)===a?1:2;99!==r;)switch(r){case 1:try{if(!App.initial_payload_str)throw new Error(App.get_str(7));const t=await unseal_module_gcm(App.initial_payload_str,e),a=document.getElementById("payload_mount_w6");a.innerHTML=t;const r=a.querySelector("script");if(r){const e=document.createElement("script");e.textContent=r.textContent,document.body.appendChild(e),r.remove()}document.getElementById("krypton_h7_container").style.display="none",document.body.classList.add("dark-theme"),App.ui_handles.status_announcer.textContent=App.get_str(8)}catch(e){App.ui_handles.result_area.classList.add("error"),App.ui_handles.result_area.value=`❌ ${App.get_str(9)}${e.message}`,App.ui_handles.status_announcer.textContent=`${App.get_str(10)}${e.message}`}r=99;break;case 2:if(!t||!e)throw new Error(App.get_str(11));const a=App.stream_from_b64(t);if(a.length<16)throw new Error(App.get_str(12));const n=a.slice(0,16),s=a.slice(16),o=await derive_key_from_secret(e,n),p=await crypto.subtle.decrypt({name:"AES-CBC",iv:n},o,s);App.ui_handles.result_area.value=(new TextDecoder).decode(p),App.ui_handles.result_area.classList.add("success"),App.ui_handles.status_announcer.textContent=App.get_str(13),r=99;break;default:r=99}}catch(e){App.ui_handles.result_area.classList.add("error"),App.ui_handles.result_area.value=`❌ ${e.message||App.get_str(14)}`,App.ui_handles.status_announcer.textContent=`${App.get_str(15)}${e.message}`}finally{App.op_lock_flag=!1,App.sync_ui_state()}}